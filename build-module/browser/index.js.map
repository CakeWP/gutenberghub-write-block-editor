{"version":3,"file":"index.js","names":["render","unmountComponentAtNode","IsolatedBlockEditor","settings","iso","moreMenu","saveBlocks","content","textarea","value","onLoad","parser","rawHandler","indexOf","HTML","attachEditor","userSettings","type","toLowerCase","editor","document","createElement","classList","add","parentNode","insertBefore","nextSibling","style","display","location","reload","detachEditor","contains","removeChild","window","wp"],"sources":["../../src/browser/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\n\nimport { render, unmountComponentAtNode } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\n\nimport './style.scss';\nimport IsolatedBlockEditor from '../index';\n\n/** @typedef {import('../index').BlockEditorSettings} BlockEditorSettings */\n\n/**\n * These are the Gutenberg and IsolatedBlockEditor settings. Everything not set uses the defaults.\n *\n * @type BlockEditorSettings\n */\nconst settings = {\n\tiso: {\n\t\tmoreMenu: false,\n\t},\n};\n\n/**\n * Saves content to the textarea\n *\n * @param {string} content Serialized block content\n * @param {HTMLTextAreaElement} textarea Textarea node\n */\nfunction saveBlocks( content, textarea ) {\n\ttextarea.value = content;\n}\n\n/**\n * Initial content loader. Determine if the textarea contains blocks or raw HTML\n *\n * @param {string} content Text area content\n * @param {*} parser Gutenberg `parse` function\n * @param {*} rawHandler Gutenberg `rawHandler` function\n */\nfunction onLoad( content, parser, rawHandler ) {\n\t// Does the content contain blocks?\n\tif ( content.indexOf( '<!--' ) !== -1 ) {\n\t\t// Parse the blocks\n\t\treturn parser( content );\n\t}\n\n\t// Raw HTML - do our best\n\treturn rawHandler( { HTML: content } );\n}\n\n/**\n * Attach IsolatedBlockEditor to a textarea\n *\n * @param {HTMLTextAreaElement} textarea Textarea node\n * @param {BlockEditorSettings} userSettings Settings object\n */\nfunction attachEditor( textarea, userSettings = {} ) {\n\t// Check it's a textarea\n\tif ( textarea.type.toLowerCase() !== 'textarea' ) {\n\t\treturn;\n\t}\n\n\t// Create a node after the textarea\n\tconst editor = document.createElement( 'div' );\n\teditor.classList.add( 'editor' );\n\n\t// Insert after the textarea, and hide it\n\t// @ts-ignore\n\ttextarea.parentNode.insertBefore( editor, textarea.nextSibling );\n\ttextarea.style.display = 'none';\n\n\t// Render the editor\n\trender(\n\t\t<IsolatedBlockEditor\n\t\t\tsettings={ { ...settings, ...userSettings } }\n\t\t\tonLoad={ ( parser, rawHandler ) => onLoad( textarea.value, parser, rawHandler ) }\n\t\t\tonSaveContent={ ( content ) => saveBlocks( content, textarea ) }\n\t\t\tonError={ () => document.location.reload() }\n\t\t></IsolatedBlockEditor>,\n\t\teditor\n\t);\n}\n\n/**\n * Remove IsolatedBlockEditor from a textarea node\n *\n * @param {HTMLTextAreaElement} textarea Textarea node\n */\nfunction detachEditor( textarea ) {\n\t/**\n\t * @type {HTMLElement}\n\t */\n\t// @ts-ignore\n\tconst editor = textarea.nextSibling;\n\n\tif ( editor && editor.classList.contains( 'editor' ) ) {\n\t\tunmountComponentAtNode( editor );\n\n\t\t// @ts-ignore\n\t\ttextarea.style.display = null;\n\t\t// @ts-ignore\n\t\teditor.parentNode.removeChild( editor );\n\t}\n}\n\n// This adds the functions to the WP global, making it easier for the example to work.\nwindow.wp = {\n\t...( window.wp ?? {} ),\n\tattachEditor,\n\tdetachEditor,\n};\n"],"mappings":";;AAAA;AACA;AACA;;AAEA,SAASA,MAAM,EAAEC,sBAAsB,QAAQ,oBAAoB;;AAEnE;AACA;AACA;;AAEA,OAAO,cAAc;AACrB,OAAOC,mBAAmB,MAAM,UAAU;;AAE1C;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAMC,QAAQ,GAAG;EAChBC,GAAG,EAAE;IACJC,QAAQ,EAAE;EACX;AACD,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,UAAU,CAAEC,OAAO,EAAEC,QAAQ,EAAG;EACxCA,QAAQ,CAACC,KAAK,GAAGF,OAAO;AACzB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASG,MAAM,CAAEH,OAAO,EAAEI,MAAM,EAAEC,UAAU,EAAG;EAC9C;EACA,IAAKL,OAAO,CAACM,OAAO,CAAE,MAAM,CAAE,KAAK,CAAC,CAAC,EAAG;IACvC;IACA,OAAOF,MAAM,CAAEJ,OAAO,CAAE;EACzB;;EAEA;EACA,OAAOK,UAAU,CAAE;IAAEE,IAAI,EAAEP;EAAQ,CAAC,CAAE;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASQ,YAAY,CAAEP,QAAQ,EAAsB;EAAA,IAApBQ,YAAY,uEAAG,CAAC,CAAC;EACjD;EACA,IAAKR,QAAQ,CAACS,IAAI,CAACC,WAAW,EAAE,KAAK,UAAU,EAAG;IACjD;EACD;;EAEA;EACA,MAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAE,KAAK,CAAE;EAC9CF,MAAM,CAACG,SAAS,CAACC,GAAG,CAAE,QAAQ,CAAE;;EAEhC;EACA;EACAf,QAAQ,CAACgB,UAAU,CAACC,YAAY,CAAEN,MAAM,EAAEX,QAAQ,CAACkB,WAAW,CAAE;EAChElB,QAAQ,CAACmB,KAAK,CAACC,OAAO,GAAG,MAAM;;EAE/B;EACA5B,MAAM,CACL,cAAC,mBAAmB;IACnB,QAAQ,EAAG;MAAE,GAAGG,QAAQ;MAAE,GAAGa;IAAa,CAAG;IAC7C,MAAM,EAAG,CAAEL,MAAM,EAAEC,UAAU,KAAMF,MAAM,CAAEF,QAAQ,CAACC,KAAK,EAAEE,MAAM,EAAEC,UAAU,CAAI;IACjF,aAAa,EAAKL,OAAO,IAAMD,UAAU,CAAEC,OAAO,EAAEC,QAAQ,CAAI;IAChE,OAAO,EAAG,MAAMY,QAAQ,CAACS,QAAQ,CAACC,MAAM;EAAI,EACtB,EACvBX,MAAM,CACN;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASY,YAAY,CAAEvB,QAAQ,EAAG;EACjC;AACD;AACA;EACC;EACA,MAAMW,MAAM,GAAGX,QAAQ,CAACkB,WAAW;EAEnC,IAAKP,MAAM,IAAIA,MAAM,CAACG,SAAS,CAACU,QAAQ,CAAE,QAAQ,CAAE,EAAG;IACtD/B,sBAAsB,CAAEkB,MAAM,CAAE;;IAEhC;IACAX,QAAQ,CAACmB,KAAK,CAACC,OAAO,GAAG,IAAI;IAC7B;IACAT,MAAM,CAACK,UAAU,CAACS,WAAW,CAAEd,MAAM,CAAE;EACxC;AACD;;AAEA;AACAe,MAAM,CAACC,EAAE,GAAG;EACX,kBAAKD,MAAM,CAACC,EAAE,mDAAI,CAAC,CAAC,CAAE;EACtBpB,YAAY;EACZgB;AACD,CAAC"}